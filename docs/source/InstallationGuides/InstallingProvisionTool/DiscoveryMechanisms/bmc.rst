BMC
---

**Pre requisites**

- IP ranges provided to Omnia for BMC discovery (bmc_dynamic_range, bmc_static_range and omnia_exclusive_static_range) should be within the same subnet but not overlap. Sample values:
    * bmc_dynamic_start_range: 172.39.0.10
    * bmc_dynamic_end_range: 172.39.0.100
    * bmc_static_start_range: 172.39.0.101
    * bmc_static_end_range: 172.39.0.250
    * omnia_exclusive_static_start_range: 172.39.1.101
    * omnia_exclusive_static_end_range: 172.39.1.254
- BMC discovery and assignment can either be static (provide ``bmc_static_start_range``, ``bmc_static_end_range``) OR dynamic ( provide ``bmc_dynamic_start_range``, ``bmc_dynamic_end_range``, ``omnia_exclusive_static_end_range``, ``omnia_exclusive_static_start_range``)
- The number of IPs available in the omnia_exclusive_static_range should be at least the same number as what's available in the bmc_dynamic_range.

The following parameters need to be populated in ``input/provision_config.yml`` to discover target nodes using BMC.

+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| Name                               | Default, Accepted Values                       | Additional Information                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Required/Optional |
+====================================+================================================+===================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+===================+
| public_nic                         | eno2                                           | The NIC/ethernet card that is connected to the public internet.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| admin_nic                          | eno1                                           | The NIC/ethernet card that is used for shared LAN over Management (LOM)   capability.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| admin_nic_subnet                   | 172.29.0.0                                     | The intended subnet for shared LOM capability. Note that since the last   16 bits/2 octets of IPv4 are dynamic, please ensure that the parameter value   is set to x.x.0.0.                                                                                                                                                                                                                                                                                                                                                                                                                                       | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| pxe_nic                            | eno1                                           | This NIC used to obtain routing information.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| discovery_mechanism                | **mapping**, bmc, snmp                         | Indicates the mechanism through   which omnia will discover nodes for provisioning. mapping indicates that the   user has provided a valid mapping file path with details regarding MAC ID of   the NIC, IP address and hostname. bmc indicates the servers in the cluster   will be discovered by Omnia using BMC. The requirement in this case is user   should enable IPMI over LAN in iDRAC settings if the iDRACs are in static   mode. snmp indicates Omnia will discover the nodes based on the switch IP (to   which the cluster servers are connected) provided. SNMP should be enabled on   the switch. | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| bmc_dynamic_start_range            |                                                | The dhcp range for assigning the IPv4 address while discovery mechanism   is BMC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                   |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| bmc_dynamic_end_range              |                                                | The dhcp range for assigning the IPv4 address while discovery mechanism   is BMC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                   |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| bmc_static_start_range             |                                                | The dhcp range for assigning the IPv4 address while discovery mechanism   is BMC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                   |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| bmc_static_end_range               |                                                | The dhcp range for assigning the IPv4 address while discovery mechanism   is BMC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                   |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| omnia_exclusive_static_start_range |                                                | The dhcp range for assigning the IPv4 address while discovery mechanism   is BMC. Mandatory when BMC dynamic ranges were provided.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                   |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| omnia_exclusive_static_end_range   |                                                | The dhcp range for assigning the IPv4 address while discovery mechanism   is BMC. Mandatory when BMC dynamic ranges were provided.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                   |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| bmc_username                       |                                                | The username for idrac. The username must not contain -,\, ',".   Required only if idrac_support: true and the discovery mechanism is BMC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                   |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| bmc_password                       |                                                | The password for idrac. The username must not contain -,\, ',".   Required only if idrac_support: true and the discovery mechanism is BMC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                   |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| pxe_subnet                         |                                                | The pxe subnet details should be provided. This is required only when   discovery mechanism is BMC. For mapping and snmp based discovery provide the   ``pxe_nic_start_range`` and ``pxe_nic_end_range``.                                                                                                                                                                                                                                                                                                                                                                                                         |                   |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| ib_nic_subnet                      |                                                | Infiniband IP  range used to assign   IPv4 addresses. When the PXE range and BMC subnet are provided, corresponding   NICs will be assigned IPs with the same 3rd and 4th octets.                                                                                                                                                                                                                                                                                                                                                                                                                                 | optional          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| node_name                          | node                                           | The intended node name for nodes in the cluster.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                   |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| domain_name                        |                                                | DNS domain name to be set for iDRAC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| provision_os                       | rocky, **rhel**                                | The operating system image that will be used for provisioning compute   nodes in the cluster.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| provision_os_version               | **8.6**, 8.0, 8.1, 8.2, 8.3, 8.4, 8.5, 8.7     | OS version of provision_os to be installed                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| iso_file_path                      | /home/RHEL-8.6.0-20220420.3-x86_64-dvd1.iso    | The path where the user places the ISO image that needs to be provisioned   in target nodes. The iso file should be Rocky8-DVD or RHEL-8.x-DVD.   ``iso_file_path`` should contain ``provision_os`` and   ``provision_os_version`` values in filename.                                                                                                                                                                                                                                                                                                                                                            | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| timezone                           | GMT                                            | The timezone that will be set during provisioning of OS. Available   timezones are provided in provision/roles/xcat/files/timezone.txt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| language                           | en-US                                          | The language that will be set during provisioning of the OS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| default_lease_time                 | 86400                                          | Default lease time in seconds that will be used by DHCP.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| provision_password                 |                                                | Password used while deploying OS on bare metal servers. The Length of the   password should be at least 8 characters. The password must not contain -,\,   ',".                                                                                                                                                                                                                                                                                                                                                                                                                                                   | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| postgresdb_password                |                                                | Password used to authenticate into the PostGresDB used by xCAT. Only   alphanumeric characters (no special characters) are accepted.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | required          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| primary_dns                        |                                                | The primary DNS host IP queried to provide Internet access to Compute   Node (through DHCP routing)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | optional          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| secondary_dns                      |                                                | The secondary DNS host IP queried to provide Internet access to Compute   Node (through DHCP routing)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | optional          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| disk_partition                     |  - { mount_point: "",   desired_capacity: "" } | User defined disk partition   applied to remote servers. The disk partition desired_capacity has to be   provided in MB. Valid mount_point values accepted for disk partition are   /home, /var, /tmp, /usr, swap. Default partition size provided for /boot is   1024MB, /boot/efi is 256MB and the remaining space to / partition.  Values are accepted in the form of JSON   list such as: , - { mount_point: "/home", desired_capacity:   "102400" },                                                                                                                                                         | optional          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| mlnx_ofed_path                     |                                                | Absolute path to a  local copy of   the .iso file containing Mellanox OFED packages. The image can be downloaded   from https://network.nvidia.com/products/infiniband-drivers/linux/mlnx_ofed/.  Sample value:   ``/root/MLNX_OFED_LINUX-5.8-1.1.2.1-rhel8.6-x86_64.iso``                                                                                                                                                                                                                                                                                                                                        | optional          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+
| cuda_toolkit_path                  |                                                | Absolute path to local copy of   .rpm file containing CUDA packages. The cuda rpm can be downloaded from   https://developer.nvidia.com/cuda-downloads. CUDA will be installed post   provisioning without any user intervention. Eg: cuda_toolkit_path:   "/root/cuda-repo-rhel8-12-0-local-12.0.0_525.60.13-1.x86_64.rpm"                                                                                                                                                                                                                                                                                       | optional          |
+------------------------------------+------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+

To continue to the next steps:

* `Pre-requisites <provisionprereqs.html>`_

* `Provisioning the cluster <installprovisiontool.html>`_