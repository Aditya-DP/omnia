Storage
=======

The storage role allows users to configure PowerVault Storage devices, BeeGFS and NFS services on the cluster.

**Installing BeeGFS**

Enter all the required parameters in ``omnia/input/storage_config.yml``

+---------------------------------+--------------------------+-----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                            | Default, accepted values | Required? | Purpose                                                                                                                                                                                        |
+=================================+==========================+===========+================================================================================================================================================================================================+
| beegfs_support                  | **FALSE**, TRUE          | Optional  | This variable is used to install beegfs-client on compute and manager   nodes                                                                                                                  |
+---------------------------------+--------------------------+-----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| beegfs_rdma_support             | **FALSE**, TRUE          | Optional  | This variable is used if user has RDMA-capable network hardware (e.g.,   InfiniBand)                                                                                                           |
+---------------------------------+--------------------------+-----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| beegfs_ofed_kernel_modules_path |                          | Optional  | The path where separate OFED kernel modules are installed.                                                                                                                                     |
+---------------------------------+--------------------------+-----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| beegfs_mgmt_server              |                          | Required  | BeeGFS management server IP                                                                                                                                                                    |
+---------------------------------+--------------------------+-----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| beegfs_mounts                   | "/mnt/beegfs"            | Optional  | Beegfs-client file system mount location. If ``storage_yml`` is being   used to change the BeeGFS mounts location, set beegfs_unmount_client to TRUE                                           |
+---------------------------------+--------------------------+-----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| beegfs_unmount_client           | **FALSE**, TRUE          | Optional  | Changing this value to true will unmount running instance of BeeGFS   client and should only be used when decommisioning BeeGFS, changing the mount   location or changing the BeeGFS version. |
+---------------------------------+--------------------------+-----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| beegfs_client_version           | 7.2.6                    | Optional  | Beegfs client version needed on compute and manager nodes.                                                                                                                                     |
+---------------------------------+--------------------------+-----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| beegfs_version_change           | **FALSE**, TRUE          | Optional  | Use this variable to change the BeeGFS version on the target nodes.                                                                                                                            |
+---------------------------------+--------------------------+-----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


To run the playbook: ::

    cd omnia/storage
    ansible-playbook storage.yml -i inventory

(Where inventory refers to the `host_inventory_file.ini <../../samplefiles.rst>`_)
